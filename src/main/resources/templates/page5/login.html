<!DOCTYPE html>
<html layout:decorate="~{layout/mainLayout}">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>epimap</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<script src="https://code.jquery.com/jquery-3.7.1.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.0/font/bootstrap-icons.css">
<script src="https://developers.kakao.com/sdk/js/kakao.js"></script>
<style>
	@font-face {
	    font-family: 'GothicA1-Light';
	    src: url('https://fastly.jsdelivr.net/gh/projectnoonnu/noonfonts_2205@1.0/GothicA1-Light.woff2') format('woff2');
	    font-weight: 300;
	    font-style: normal;
	}
	
	@font-face {
	    font-family: 'GothicA1-Bold';
	    src: url('https://fastly.jsdelivr.net/gh/projectnoonnu/noonfonts_2205@1.0/GothicA1-Bold.woff2') format('woff2');
	    font-weight: 700;
	    font-style: normal;
	}
	
	html, body {
	margin: 0;
	padding: 0;
	height: 100%;
	overflow-x: hidden;
	}
	
	body {
		font-family: 'GothicA1-Light', sans-serif;
	}
	
	.box {
		margin: 0 auto;
		margin-top : 149px;
		/* margin-left: 32px; */
		width: 350px;
		height: 346px;
		background-color: #ffffff;
		border-radius: 10px;
		box-shadow: 0px 1px 20px #c4d0d566, 0px 7px 10px #c5d0d640;
	}
	.login1 {
		width: 350px;
		height: 90px;
		line-height: 90px;
		border-radius: 10px;
		/* box-shadow: 0px 1px 20px #c4d0d566, 0px 7px 10px #c5d0d640;
		background: #0062ff; */
		box-shadow: 0 1px 20px #c4d0d566, 0 7px 10px #c5d0d640, 0 4 20px #96a7af66;
		background: linear-gradient(
			150deg,
			rgba(1, 57, 254, 0.4) 0%,
			rgba(16, 241, 255, 0.4) 100%
		), linear-gradient(0deg, rgba(0,98,255,1) 0%, rgba(0,98,255,1) 100%);
		text-align: left;
		color:white;
		font-size: 24px;
		font-family: 'GothicA1-bold', sans-serif;
		font-weight: 900;
		border: 1px solid white;
	}
	.login2 {
		margin-left: 15px;
		margin-top:25px;
		width: 319px;
		height: 50px;
		background-color: #ffffff;
		border-radius: 10px;
		box-shadow: 0px 1px 20px #c4d0d566, 0px 7px 10px #c5d0d640;
		border: 1px solid white;
		font-size: 16px;
		font-weight: bold;
		font-family: 'GothicA1-Light', sans-serif;
	}
	.password {
		margin-left: 15px;
		margin-top:15px;
		width: 319px;
		height: 50px;
		background-color: #ffffff;
		border-radius: 10px;
		box-shadow: 0px 1px 20px #c4d0d566, 0px 7px 10px #c5d0d640;
		border: 1px solid white;
		font-size: 16px;
		font-weight: bold;
		font-family: 'GothicA1-Light', sans-serif;
	}
	.loginbtn {	
		width:78px;
		height: 30px;
		background-color: #0062ff;
		border-radius: 20px;
		color: white;
		font-size: 14px;
		font-weight: bold;
		font-family: 'GothicA1-Light', sans-serif;
		border: 1px solid white;
		float: right;
		margin-top: 20px;
		margin-right: 15px;
	}
	.signupbtn {
		width: 75px;
		height: 27px;
		border: 1px solid white;
		border-radius: 20px;
		font-size: 14px;
		font-weight: bold;
		font-family: 'GothicA1-Light', sans-serif;
		background-color: #ffffff;
		color: #0062ff;
		float: left;
		margin-left: 135px;
	}
	.pageend{
		margin: 0 auto;
		width: 100vw;
		height: 23px;
		font-family: 'MarinesBold', sans-serif;
		color: #0062ff;
		text-align: center;
		font-size: 18px;
		line-height: 23.4px;
		margin-top: 20px;
	}
	.chk {
		 margin-left: 20px;
		 margin-bottom: -10px;
		 font-size: 10px;
		 font-family: 'GothicA1-Light', sans-serif;
	}
	.kakaoimg {
		width: 100px;
		height: 28px;
		margin-left: 150px;
		margin-top: -60px;
		border-radius: 15px;
	}
</style>
</head>
<body>
<div layout:fragment="content" style="width: 100vw;">
	<div class="box">	
		<div class="login1">&nbsp;&nbsp;로그인</div>
				<form th:action="@{/login}" th:object="${users}" method="post">
					<input class="login2" type="text" th:field="*{user_id}" placeholder="&nbsp;&nbsp;아이디" autofocus="autofocus" required="required"><br>
					<input class="password" type="password" th:field="*{password}" value="" placeholder="&nbsp;&nbsp;비밀번호" required="required">
					<br>
					<span class="chk" th:text="${error}" th:style="${error} ? 'color:red; display:block;' : 'display:none;'"></span>		
					<button class="loginbtn"type="submit">로그인</button>
				</form>
				<button class="kakaobtn" style=" border: none; background: none;" onclick="kakaoLogin()">
					  <img src="./kakao_login_medium_narrow.png" class="kakaoimg" alt="카카오 연결"/>
				</button>
		<button class="signupbtn" type="button" onclick="location.href='/signup'">회원가입</button>
	</div>
	<div class="pageend">MediTrackers</div>
	<script type="text/javascript">
	  Kakao.init('55844f9373522ab837bcc9a12eaff759');
	
	  function kakaoLogin() {
		  Kakao.Auth.login({
		    scope: 'profile_nickname',
		    success: function(authObj) {
		      Kakao.API.request({
		        url: '/v2/user/me',
		        success: function(res) {
		          const kakao_id = res.id;
		          const kakao_nickname = res.properties.nickname;

		          $.post("/kakaoLogin", {
		            kakao_id,
		            kakao_nickname
		          }, function(result) {
		            if (result === "signup") {
		              alert("카카오 회원가입 완료!");
		            } else if (result === "login") {
		              alert("카카오 로그인 완료!");
		            } else {
		              alert("오류: " + result);
		            }
		            location.href = "/mypage";
		          });
		        }
		      });
		    },
		    fail: function(err) {
		      alert("카카오 로그인 실패");
		    }
		  });
		}
	</script>
</div>
</body>
</html>     
