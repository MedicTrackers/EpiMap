<!DOCTYPE html>
<html layout:decorate="~{layout/mainLayout}">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ê³µì§€ì‚¬í•­</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.7.1.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.0/font/bootstrap-icons.css">
    <style>
        body * {
            font-family: 'GothicA1-Light', sans-serif;
        }

        .overview {
            width: 100%;
            max-width: 375px;
            height: 107px;
            border: 1px solid gray;
            padding: 10px;
            box-shadow: 0 1px 20px #c4d0d566, 0 7px 10px #c5d0d640, 0 4px 20px #96a7af66;
            background: linear-gradient(150deg, rgba(1, 57, 254, 0.4) 0%, rgba(16, 241, 255, 0.4) 100%),
            linear-gradient(0deg, rgba(0, 98, 255, 1) 0%, rgba(0, 98, 255, 1) 100%);
            border-radius: 10px;
            color: white;
            font-weight: bold;
            position: fixed; /* ê³ ì • ìœ„ì¹˜ ì„¤ì • */
            top: 132px; /* ì›í•˜ëŠ” ìœ„ì¹˜ì— ê³ ì • */
            transform: translateX(-50%);
            left: 50%;
            z-index: 1;
            text-align: center;
        }

        .profile-image{
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background-color: #0062FF;
            object-fit: cover;
        }

        .notice-detail {
            left: 10px;
            right: 10px;
            position: fixed;
            top: 170px;
            bottom: 20px;
            max-height: calc(100vh - 180px);
            background-color: #fdfdfd;
            z-index: 3; /* ê³µì§€ ë°°ë„ˆë³´ë‹¤ ìœ„ì— ë°°ì¹˜ */
            border-top-left-radius: 15px;
            border-top-right-radius: 15px;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.5);
        }

        hr {
            margin-left: -20px;
        }

        .carousel-item img {
            max-height: 400px;           /* ì›í•˜ëŠ” ë†’ì´ë¡œ ê³ ì • */
            width: 100%;             /* ìºëŸ¬ì…€ ë„ˆë¹„ì— ë§ì¶¤ */
            object-fit: contain;       /* ë¹„ìœ¨ ìœ ì§€í•˜ë©´ì„œ ìë¥´ê¸° */
        }
        .notice-list-inner {
            height: calc(100vh - 120px); /* ë¶€ëª¨ divì˜ ë†’ì´ë¥¼ 100%ë¡œ ì„¤ì • */
            overflow-y: auto;
        }

        .notice-header {
            display: flex;
            justify-content: space-between; /* ì œëª©ê³¼ ë²„íŠ¼ì„ ì–‘ìª½ ì •ë ¬ */
            align-items: flex-end; /* ë²„íŠ¼ì„ ì•„ë˜ìª½ìœ¼ë¡œ ë°°ì¹˜ */
            padding: 10px;
            margin-left: 10px;
        }

        .page5_title {
            font-size: 28px;
            font-weight: bold;
            color: #0062FF;
        }

        .subject,
        .ncontent,
        .profile-image {
            margin-left: 10px; /* ì›í•˜ëŠ” ê°’(px, rem ë“±ìœ¼ë¡œ ì¡°ì ˆ ê°€ëŠ¥) */
        }

        .fixed-nav-buttons {
            left: 50%;
            bottom: 20px;
            z-index: 10;
            background: white;
            padding:  10px;
            display: flex;
            gap: 10px;
        }

        .btn-wrapper {
            display: flex;
            margin-top: 10px; /* í•„ìš”ì‹œ ê°„ê²© ì¡°ì • */
        }

        .btn-edit-delete-group {
            display: inline-flex;
            border: 1px solid #ccc;
            border-radius: 8px;
            overflow: hidden;
            background-color: #f0f0f0;
            font-weight: bold;
        }

        .btn-edit-delete-group a {
            display: flex;
            align-items: center;
            padding: 8px 14px;
            text-decoration: none;
            color: #333;
            font-size: 14px;
        }

        .btn-edit-delete-group a i {
            color: #b388ff; /* ë³´ë¼ìƒ‰ ì•„ì´ì½˜ */
            margin-right: 6px;
        }

        /* ê°€ìš´ë° ê²½ê³„ì„  */
        .btn-edit-delete-group a + a {
            border-left: 1px solid #ccc;
        }


    </style>
</head>
<body>
<div layout:fragment="content">
    <div class="overview">
        <p>EpiMap ì—ì„œ ë¹ ë¥´ê²Œ ì •ë¶€ ì†Œì‹ì„ ë°›ì•„ë³´ì„¸ìš”</p>
    </div>
    <div class="notice-detail">
        <div class="notice-list-inner">
            <!-- ìƒë‹¨ë¶€ -->
            <div class="notice-header ">
                <b class="page5_title">ê³µì§€ì‚¬í•­</b>
            </div>
            <hr>

            <!-- ì œëª© + ì‘ì„±ì¼ì -->
            <div class="d-flex justify-content-between align-items-center mb-3">
                <!-- ì œëª© -->
                <h4 class="subject mb-0"
                    th:text="${dto.subject}">ì œëª©ì…ë‹ˆë‹¤
                </h4>
                <!-- ì‘ì„±ì¼ì -->
                <div class="text-muted small" th:text="${#dates.format(dto.writeday, 'yyyy-MM-dd HH:mm')}" style="margin-right: 10px ">2025-04-07 15:00</div>
            </div>


            <!-- ì‘ì„±ì í”„ë¡œí•„ -->
            <div class="d-flex align-items-center gap-2 mb-3">
                <img src="/doctor1.png" class="profile-image" alt="ì‘ì„±ì" style="width: 40px; height: 40px; border-radius: 50%;">
                <div>
                    <div class="profile-info-name fw-bold" th:text="${dto.nickname}">ì‘ì„±ì</div>
                </div>
            </div>


            <div id="imageCarousel" class="carousel slide" data-bs-ride="carousel"
                 th:if="${dto.nphotoList != null and #lists.size(dto.nphotoList) > 0}">

                <!-- Indicators: ì‚¬ì§„ì´ 2ì¥ì´ìƒì¼ ë•Œë§Œ ë³´ì´ê²Œ -->
                <div class="carousel-indicators"
                     th:if="${#lists.size(dto.nphotoList) > 1}">
                    <th:block th:each="photo, stat : ${dto.nphotoList}">
                        <button type="button"
                                th:data-bs-target="'#imageCarousel'"
                                th:data-bs-slide-to="${stat.index}"
                                th:classappend="${stat.index == 0} ? 'active' : ''"
                                aria-current="true"
                                th:aria-label="'Slide ' + ${stat.index + 1}">
                        </button>
                    </th:block>
                </div>

                <!-- Carousel Inner -->
                <div class="carousel-inner">
                    <th:block th:each="photo, stat : ${dto.nphotoList}">
                        <div class="carousel-item" th:classappend="${stat.index == 0} ? 'active' : ''">
                            <img th:src="@{|${imagePath}${photo}|}" class="d-block w-100" alt="Image Slide">
                        </div>
                    </th:block>
                </div>

                <!-- Controls: ì‚¬ì§„ì´ 2ì¥ì´ìƒì¼ ë•Œë§Œ ë³´ì´ê²Œ -->
                <button class="carousel-control-prev" type="button" data-bs-target="#imageCarousel" data-bs-slide="prev"
                        th:if="${#lists.size(dto.nphotoList) > 1}">
                    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                    <span class="visually-hidden">Previous</span>
                </button>
                <button class="carousel-control-next" type="button" data-bs-target="#imageCarousel" data-bs-slide="next"
                        th:if="${#lists.size(dto.nphotoList) > 1}">
                    <span class="carousel-control-next-icon" aria-hidden="true"></span>
                    <span class="visually-hidden">Next</span>
                </button>

            </div>
            <!-- ë‚´ìš© -->
            <div class="ncontent" th:utext="${dto.content}"></div>

            <!-- ì´ì „/ëª©ë¡/ë‹¤ìŒ ë²„íŠ¼ (ê³ ì •) -->
            <div class="fixed-nav-buttons">
                <th:block th:if="${prev != null}">
                    <a th:href="@{/notice/detail(boards_id=${prev.boards_id}, pageNum=${pageNum})}" class="btn btn-outline-secondary text-nowrap">
                        â† ì´ì „ê¸€
                    </a>
                </th:block>

                <a th:href="@{/notice(pageNum=${pageNum})}" class="btn btn-outline-secondary text-nowrap">ğŸ“„ ëª©ë¡</a>


                <th:block th:if="${next != null}">
                    <a th:href="@{/notice/detail(boards_id=${next.boards_id}, pageNum=${pageNum})}" class="btn btn-outline-secondary text-nowrap">
                        ë‹¤ìŒê¸€ â†’
                    </a>
                </th:block>
            </div>

            <!-- êµ¬ë¶„ì„  -->
            <hr class="mt-3 mb-2">

            <!-- ì²¨ë¶€íŒŒì¼ -->
            <th:block th:if="${dto.nfile != null}">
                <div class="file-section">
                    <span>ì²¨ë¶€íŒŒì¼ :
                        <a th:href="@{|${filePath}${dto.nfile}|}" download>[[${dto.nfile}]]</a>
                    </span>
                </div>
            </th:block>

            <!-- ìˆ˜ì • / ì‚­ì œ ë²„íŠ¼ (ìš°ì¸¡ í•˜ë‹¨ ì •ë ¬) -->
            <div class="btn-wrapper">
                <div class="btn-edit-delete-group">
                    <th:block th:if="${session.loginUser != null and session.loginUser.users_id == dto.users_id}">
                        <a th:href="@{/notice/updateform(boards_id=${dto.boards_id}, pageNum=${pageNum})}">
                            <i class="bi bi-pencil-fill"></i> ìˆ˜ì •
                        </a>
                        <a th:href="@{/notice/delete(boards_id=${dto.boards_id})}"
                           onclick="return confirm('ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')">
                            <i class="bi bi-trash-fill"></i> ì‚­ì œ
                        </a>
                    </th:block>
                </div>
            </div>
        </div>
    </div>
</div>
</body>
</html>
